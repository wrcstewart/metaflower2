<!DOCTYPE html>
<html lang="en">

<head>

<style>
* {
  box-sizing: border-box;
    padding:0px;

    margin:0px;
    list-style-position: inside;
 list-style-type:none
}

#outer {
        background-color:rgb(253,253,253) ;
        position:absolute;
        top:250px;
        width:400px;
        height:400px;
        left:10px;
      }
#buttonbar{
    background-color:rgb(240,240,240) ;
        position:absolute;
        top:220px;
        width:300px;
        height:30px;
        left:10px;
    fonts-size:18;
    size:18
}
#privateListContainerID {
    padding:4px;
}
ol {
padding:5px;
}

li {
    border:2px;
    border-style:solid;
    border:rgb(0,0,0)
}
</style>


<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js">
    </script>

    <script src="/socket.io/socket.io.js"></script>

</head>

<body onload = "setUpPage()">

<!-- the main lists -->
<div id = "privateListContainerID">
    <ol id = "privateListID" reversed>
    </ol>
</div>

<!-- a debug pane -->
<div id="test">test div</div>

<!-- mainly devel buttons -->
<div id = "buttonbar">
    <button id="copyOutButID" style="width:50px" onclick="doCopyOut()"> ⬅︎ ⬆︎︎ </button>
    <button id="copyToEditButID" style="width:50px" onclick="doCopyToEdit()"> ⬇︎ </button>
     <button id="setUser1ButID" style="width:50px" onclick="doSetUser1()">Set To User1</button>
    <button id="setUser2ButID" style="width:50px" onclick="doSetUser2()">Set To User2</button>
    <button id="setUser3ButID" style="width:50px" onclick="doSetUser3()">Set To User3</button>
</div>

<!-- container div for the summernote div / seems way to style summernote -->
<div id="outer">
    <div id="summernote"></div>
</div>


</body>



<script>
    function setUpPage(){

    window.selectedListId = null;

    setStyle("test","1px","400px","700px","100px","MediumSeaGreen");

    setStyle("privateListContainerID","1px","400px","1px","200px","rgb(240,240,240)");
    document.getElementById("privateListContainerID").style.overflow = "scroll";

    setStyle("privateListID","1px","400px","1px","199px","rgb(240,240,240");
    document.getElementById("privateListID").style.overflow = "scroll";

    //let ta1 = document.getElementById("ta1");
    //ta1.addEventListener('keyup',logKey1);

   $('#summernote').summernote({
       placeholder: 'Hello stand alone ui',
        height:300
      });

}//end setUpPage ------------------------------------------------------------------------------------------------------






    var socket = io();

    socket.on('chat message', function(msg) {

        let privateListID = document.getElementById("privateListID");

        let items = privateListID.getElementsByTagName("li");
        let lenList = items.length;
        let newIDNumber = lenList +1;
        let newID = "listItemID"+ newIDNumber;

        if(window.selectedListId){
            let oldListEl = document.getElementById(window.selectedListId);
            oldListEl.style.borderStyle = "dotted";
        oldListEl.style.borderColor = "rgb(196,196,196)";
         oldListEl.style.borderWidth = "1px";
        }


        let aListEl = document.createElement('li');
        aListEl.id = newID;
        window.selectedListId = newID;
        aListEl.style.borderStyle = "solid";
        aListEl.style.borderColor = "rgb(190,190,190)";
        aListEl.style.borderWidth = "2px";


        if (msg.user == "buddy"){
            aListEl.style.backgroundColor = "rgb(220,255,220)"
        } else {
             aListEl.style.backgroundColor = "rgb(240,240,240)"

        }

        aListEl.innerHTML = msg.message;


        aListEl.addEventListener('dblclick',listClick);
        privateListID.insertBefore(aListEl,privateListID.childNodes[0]);
    });

</script>

<script>
window.user = "user1";
show("user1 set");



function listClick(e){

    var clickedID = this.id;

if(window.selectedListId){
            let oldListEl = document.getElementById(window.selectedListId);
            oldListEl.style.borderStyle = "dotted";
        oldListEl.style.borderColor = "rgb(196,196,196)";
         oldListEl.style.borderWidth = "1px";

        }


let newSelectedEl =document.getElementById(clickedID );

 newSelectedEl.style.borderStyle = "solid";
        newSelectedEl.style.borderColor = "rgb(190,190,190)";
        newSelectedEl.style.borderWidth = "2px";



    window.selectedListId = clickedID;

    doCopyToEdit();




    //let testHTML = document.getElementById("test").innerHTML;
  // testHTML = this.innerHTML;
   //testHTML = testHTML + "<br" + socket.id;
document.getElementById("test").innerHTML = this.innerHTML;
let testStuff = document.getElementById("test").innerHTML;
document.getElementById("test").innerHTML = testStuff + "<br>" +socket.id;


//document.getElementById("test").innerHTML = document.getElementById("test").innerHTML + "<br>" +socket2.id;

//document.getElementById("test").innerHTML =  + "<br>" +socket2.id;

}

function setStyle(elementId,left,width,top,height,bkColor){
    let el = document.getElementById(elementId);
    el.style.fontFamily = "Arial, Helvetica, sans-serif";
    el.style.position = "absolute";
    el.style.left = left; el.style.width =width;
    el.style.top = top ; el.style.height = height;
    //el.innerText = "cat"


   el.style.backgroundColor = bkColor;
}//end setStyle




function doCopyOut(){

 //let ta1 = document.getElementById("ta1");
    //let privateListID = document.getElementById("privateListID");
   // let items = privateListID.getElementsByTagName("li");
   // let lenList = items.length;
    //let newIDNumber = lenList +1;
   // let newID = "listItemID"+ newIDNumber;
   // let htmlIdPhrase = "<li id=" +newID +">";


    //let myString = ta1.value; ta1.value = "";

    let myString = $('#summernote').summernote('code');

    //privateListID.innerHTML = htmlIdPhrase + myString +"</li>" + privateListID.innerHTML;

    socket.emit('chat message',myString );

}

function doCopyToEdit(){
        let elLiEl = gEl(window.selectedListId);
        let tempString = elLiEl.innerHTML + $('#summernote').summernote('code');
        $('#summernote').summernote('code',tempString) ;
    }
// bit lazy below but is only temp
function doSetUser1(){
    window.user = "user1";
    show("user1 set");
    let socketID = socket.id;
    let user = "user1"
    let userData = {socketID:socketID, user:user}
    socket.emit('client data',userData );
}

function doSetUser2(){
    window.user = "user2"
    show("user2 set");
    let socketID = socket.id;
    let user = "user2"
    let userData = {socketID:socketID, user:user}
    socket.emit('client data',userData );
}

function doSetUser3(){
    window.user = "user3";
    show("user3 set");
    let socketID = socket.id;
    let user = "user3"
    let userData = {socketID:socketID, user:user}
    socket.emit('client data',userData );
}

//utility functions
function show(aString){
document.getElementById("test").innerHTML = aString +"<br>";
}

function gEl(id){return( document.getElementById(id))}
</script>

</html>